


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Creating AnyScript Macros &#8212; AnyPyTools 0.14.0 documentation</title>
    <link rel="stylesheet" href="../_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/cloud.base.js"></script>
    <script type="text/javascript" src="../_static/cloud.js"></script>
    <link rel="shortcut icon" href="../_static/anypytools.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with data from AnyBody" href="03_Working_with_output_from_Anybody.html" />
    <link rel="prev" title="Getting Started with AnyPyTools" href="01_Getting_started_with_anypytools.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../index.html" title="Table Of Contents"
             accesskey="C">toc</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="03_Working_with_output_from_Anybody.html" title="Working with data from AnyBody"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="01_Getting_started_with_anypytools.html" title="Getting Started with AnyPyTools"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">AnyPyTools 0.14.0 documentation</a> &#187;</li>
 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for cloud theme */

/* nicer titles and more space for info and warning logos */

div.admonition p.admonition-title {
    background: rgba(0, 0, 0, .05);
    margin: .5em -1em;
    margin-top: -.5em !important;
    padding: .5em .5em .5em 2.65em;
}

/* indent single paragraph */
div.admonition {
    text-indent: 20px;
}
/* don't indent multiple paragraphs */
div.admonition > p {
    text-indent: 0;
}
/* remove excessive padding */
div.admonition.inline-title p.admonition-title {
    padding-left: .2em;
}
</style>
<div class="section" id="Creating-AnyScript-Macros">
<h1>Creating AnyScript Macros<a class="headerlink" href="#Creating-AnyScript-Macros" title="Permalink to this headline">¶</a></h1>
<p>AnyPyTools can create AnyScript macros automatically. Doing so
simplifies the process of writing complex macros and makes it easier to
do things like parameter studies, Monte Carlo simulation, etc.</p>
<p>There is a class for every macro command:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">anypytools.macro_commands</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MacroCommand</span><span class="p">,</span> <span class="n">Load</span><span class="p">,</span> <span class="n">SetValue</span><span class="p">,</span> <span class="n">SetValue_random</span><span class="p">,</span>  <span class="n">Dump</span><span class="p">,</span> <span class="n">SaveDesign</span><span class="p">,</span>
                                       <span class="n">LoadDesign</span><span class="p">,</span> <span class="n">SaveValues</span><span class="p">,</span> <span class="n">LoadValues</span><span class="p">,</span> <span class="n">UpdateValues</span><span class="p">,</span> <span class="n">OperationRun</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="A-quick-example">
<h2>A quick example<a class="headerlink" href="#A-quick-example" title="Permalink to this headline">¶</a></h2>
<p>The following shows how the to generate a simple macro.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">macrolist</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Load</span><span class="p">(</span><span class="s1">&#39;Knee.any&#39;</span><span class="p">,</span> <span class="n">defs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;SUBJECT&#39;</span><span class="p">:</span><span class="s1">&#39;&quot;S02&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIAL&#39;</span><span class="p">:</span><span class="s1">&#39;&quot;T04&quot;&#39;</span><span class="p">}),</span>
    <span class="n">OperationRun</span><span class="p">(</span><span class="s1">&#39;Main.MyStudy.InverseDynamics&#39;</span><span class="p">),</span>
    <span class="n">Dump</span><span class="p">(</span><span class="s1">&#39;Main.MyStudy.Output.MaxMuscleActivity&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">macrolist</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[2]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[load &quot;Knee.any&quot; -def SUBJECT=---&quot;\&quot;S02\&quot;&quot; -def TRIAL=---&quot;\&quot;T04\&quot;&quot;,
 operation Main.MyStudy.InverseDynamics
 run,
 classoperation Main.MyStudy.Output.MaxMuscleActivity &quot;Dump&quot;]
</pre></div>
</div>
</div>
<p>Each macro object will generate the macro commands with the correct
syntax. The macro can be launched using the <code class="docutils literal notranslate"><span class="pre">start_macro()</span></code> method of
the <code class="docutils literal notranslate"><span class="pre">AnyPyProcess</span></code> object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">anypytools</span> <span class="kn">import</span> <span class="n">AnyPyProcess</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">AnyPyProcess</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">start_macro</span><span class="p">(</span><span class="n">macrolist</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "25cab71e56be44a1809cada9f056b1b8"}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "aba550b00e0e42d0ad0a3bcf49693546"}</script></div>
</div>
</div>
<div class="section" id="Overview-of-macro-commands">
<h2>Overview of macro commands<a class="headerlink" href="#Overview-of-macro-commands" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">macro_commands</span></code> module have classes for generating many of the
standard AnyScipt macro commands.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Load(mainfile,</span> <span class="pre">defines,</span> <span class="pre">paths)</span></code>: load command</li>
<li><code class="docutils literal notranslate"><span class="pre">OperationRun(var)</span></code>: select operation and run</li>
<li><code class="docutils literal notranslate"><span class="pre">Dump(var)</span></code>: classoperation “Dump”</li>
<li><code class="docutils literal notranslate"><span class="pre">LoadDesign(var,</span> <span class="pre">filename)</span></code>: classoperation “Load design”</li>
<li><code class="docutils literal notranslate"><span class="pre">SaveDesign(var,</span> <span class="pre">filename)</span></code>: classoperation “Save design”</li>
<li><code class="docutils literal notranslate"><span class="pre">LoadValues(filename)</span></code>: classoperation Main “Load Values”</li>
<li><code class="docutils literal notranslate"><span class="pre">SaveValues(filename)</span></code>: classoperation Main “Save Values”</li>
<li><code class="docutils literal notranslate"><span class="pre">UpdateValues()</span></code>: classoperation “Update Values”</li>
<li><code class="docutils literal notranslate"><span class="pre">SetValue(var,value)</span></code>: classoperation “Set Value”</li>
<li><code class="docutils literal notranslate"><span class="pre">MacroCommand(macro_string)</span></code>: Add abitrary macro string</li>
</ul>
</div>
<div class="section" id="Creating-many-macros">
<h2>Creating many macros<a class="headerlink" href="#Creating-many-macros" title="Permalink to this headline">¶</a></h2>
<p>The macro in the previous example would have been easy to write
manually. However, in some cases we want to create many macros. Then it
is a big advantage to generate them programmatically.</p>
<p>To generate many macros we need an extra class <code class="docutils literal notranslate"><span class="pre">AnyMacro</span></code> to wrap our
macro list.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">anypytools</span> <span class="kn">import</span> <span class="n">AnyMacro</span>

<span class="n">macrolist</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Load</span><span class="p">(</span><span class="s1">&#39;Knee.any&#39;</span> <span class="p">),</span>
    <span class="n">OperationRun</span><span class="p">(</span><span class="s1">&#39;Main.MyStudy.InverseDynamics&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">mg</span> <span class="o">=</span> <span class="n">AnyMacro</span><span class="p">(</span><span class="n">macrolist</span><span class="p">)</span>
<span class="n">mg</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[[&#39;load &quot;Knee.any&quot;&#39;, &#39;operation Main.MyStudy.InverseDynamics&#39;, &#39;run&#39;]]
</pre></div>
</div>
</div>
<p>By default <code class="docutils literal notranslate"><span class="pre">AnyMacro</span></code> just behaves as a container for our macro. But
has additional attributes that specify how many macros we want.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mg</span> <span class="o">=</span> <span class="n">AnyMacro</span><span class="p">(</span><span class="n">macrolist</span><span class="p">,</span> <span class="n">number_of_macros</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">mg</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[[&#39;load &quot;Knee.any&quot;&#39;, &#39;operation Main.MyStudy.InverseDynamics&#39;, &#39;run&#39;],
 [&#39;load &quot;Knee.any&quot;&#39;, &#39;operation Main.MyStudy.InverseDynamics&#39;, &#39;run&#39;],
 [&#39;load &quot;Knee.any&quot;&#39;, &#39;operation Main.MyStudy.InverseDynamics&#39;, &#39;run&#39;],
 [&#39;load &quot;Knee.any&quot;&#39;, &#39;operation Main.MyStudy.InverseDynamics&#39;, &#39;run&#39;],
 [&#39;load &quot;Knee.any&quot;&#39;, &#39;operation Main.MyStudy.InverseDynamics&#39;, &#39;run&#39;]]
</pre></div>
</div>
</div>
<p>This can also be overidden when calling its <code class="docutils literal notranslate"><span class="pre">create_macros()</span></code> function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mg</span><span class="o">.</span><span class="n">create_macros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[[&#39;load &quot;Knee.any&quot;&#39;, &#39;operation Main.MyStudy.InverseDynamics&#39;, &#39;run&#39;],
 [&#39;load &quot;Knee.any&quot;&#39;, &#39;operation Main.MyStudy.InverseDynamics&#39;, &#39;run&#39;]]
</pre></div>
</div>
</div>
<p>This list of macros can also be passed to the ‘start_macro’ function to
executed in parallel.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">anypytools</span> <span class="kn">import</span> <span class="n">AnyPyProcess</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">AnyPyProcess</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">start_macro</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">create_macros</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b28691033a9448ac990265d31995e221"}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "56d48fa18f9c4a48b585e6e9e645f002"}</script></div>
</div>
<p>Running many macros is only really useful if the macros are different.
Some macros classes, like <code class="docutils literal notranslate"><span class="pre">SetValue()</span></code>, accepts lists of values which
it distributes across the generated macros.</p>
<p>Imagine a list of 5 parameters. We want to create five macros that use
these values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">parameter_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">]</span>

<span class="n">mg</span> <span class="o">=</span> <span class="n">AnyMacro</span><span class="p">(</span><span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;Main.MyParameter&#39;</span><span class="p">,</span> <span class="n">parameter_list</span> <span class="p">))</span>
<span class="n">mg</span><span class="o">.</span><span class="n">create_macros</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[[&#39;classoperation Main.MyParameter &quot;Set Value&quot; --value=&quot;2.2&quot;&#39;],
 [&#39;classoperation Main.MyParameter &quot;Set Value&quot; --value=&quot;2.5&quot;&#39;],
 [&#39;classoperation Main.MyParameter &quot;Set Value&quot; --value=&quot;2.7&quot;&#39;],
 [&#39;classoperation Main.MyParameter &quot;Set Value&quot; --value=&quot;2.9&quot;&#39;],
 [&#39;classoperation Main.MyParameter &quot;Set Value&quot; --value=&quot;3.1&quot;&#39;]]
</pre></div>
</div>
</div>
<div class="section" id="A-simple-parameter-study">
<h3>A simple parameter study<a class="headerlink" href="#A-simple-parameter-study" title="Permalink to this headline">¶</a></h3>
<p>Let us combine the previous to create a parameter study. We will
continue with the simplified knee model where we left off in the
previous tutorial. The parameter study will vary the patella tendon
length from 2.0cm to 8.0cm, and observe the effect on maximum muscle
activity.</p>
<p>First we create a list of patella length parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">patella_tendon_lengths</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.02</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mf">0.01</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">patella_tendon_lengths</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08]
</pre></div></div>
</div>
<p>This list of values is added to the macros with the <code class="docutils literal notranslate"><span class="pre">SetValue</span></code> class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">macro</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Load</span><span class="p">(</span><span class="s1">&#39;Knee.any&#39;</span><span class="p">),</span>
    <span class="n">SetValue</span><span class="p">(</span><span class="s1">&#39;Main.MyModel.PatellaLigament.DriverPos&#39;</span><span class="p">,</span> <span class="n">patella_tendon_lengths</span> <span class="p">),</span>
    <span class="n">OperationRun</span><span class="p">(</span><span class="s1">&#39;Main.MyStudy.InverseDynamics&#39;</span><span class="p">),</span>
    <span class="n">Dump</span><span class="p">(</span><span class="s1">&#39;Main.MyStudy.Output.Abscissa.t&#39;</span><span class="p">),</span>
    <span class="n">Dump</span><span class="p">(</span><span class="s1">&#39;Main.MyStudy.Output.MaxMuscleActivity&#39;</span><span class="p">),</span>
    <span class="n">Dump</span><span class="p">(</span><span class="s1">&#39;Main.MyModel.PatellaLigament.DriverPos&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">parameter_study_macro</span> <span class="o">=</span> <span class="n">AnyMacro</span><span class="p">(</span><span class="n">macro</span><span class="p">,</span> <span class="n">number_of_macros</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">patella_tendon_lengths</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can now run the model and analyze the resulting maximum muscle
activity by plotting the data in the <code class="docutils literal notranslate"><span class="pre">output</span></code> variable:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">output</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">start_macro</span><span class="p">(</span><span class="n">parameter_study_macro</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1b82c84c0ea94413aebd4310ea3e4332"}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8d3c18178021424b8da24b0e41a674bc"}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
    <span class="n">max_activity</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Main.MyStudy.Output.MaxMuscleActivity&#39;</span><span class="p">]</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Main.MyStudy.Output.Abscissa.t&#39;</span><span class="p">]</span>
    <span class="n">patella_ligament_length</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Main.MyModel.PatellaLigament.DriverPos&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">max_activity</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;{:.1f} cm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span> <span class="n">patella_ligament_length</span><span class="p">)</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Effect of changing patella tendon length&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time steps&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Max muscle activity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Tutorial_02_Generating_macros_27_0.png" src="../_images/Tutorial_02_Generating_macros_27_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../index.html" title="index">
          <img class="logo" src="../_static/anypytools_logo.png" alt="Logo"/>
        </a></p><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="../index.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Creating AnyScript Macros</a><ul>
<li><a class="reference internal" href="#A-quick-example">A quick example</a></li>
<li><a class="reference internal" href="#Overview-of-macro-commands">Overview of macro commands</a></li>
<li><a class="reference internal" href="#Creating-many-macros">Creating many macros</a><ul>
<li><a class="reference internal" href="#A-simple-parameter-study">A simple parameter study</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="01_Getting_started_with_anypytools.html"
                          title="Previous page">&larr; Getting Started with AnyPyTools</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="03_Working_with_output_from_Anybody.html"
                          title="Next page">&rarr; Working with data from AnyBody</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Tutorial/02_Generating_macros.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../index.html" title="Table Of Contents"
             >toc</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="03_Working_with_output_from_Anybody.html" title="Working with data from AnyBody"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="01_Getting_started_with_anypytools.html" title="Getting Started with AnyPyTools"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">AnyPyTools 0.14.0 documentation</a> &#187;</li>
 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Morten Enemark Lund.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>